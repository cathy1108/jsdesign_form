<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>捷士設計 | 需求引導系統</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans TC', sans-serif; background-color: #f8fafc; }
        .animate-in { animation: fadeIn 0.4s ease-out forwards; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
        .custom-scroll::-webkit-scrollbar { width: 4px; }
        .custom-scroll::-webkit-scrollbar-track { background: transparent; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #e2e8f0; border-radius: 10px; }
        input[type="range"]::-webkit-slider-thumb { -webkit-appearance: none; appearance: none; width: 24px; height: 24px; background: #f59e0b; border-radius: 50%; cursor: pointer; border: 4px solid white; box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;
        
        const Icon = ({ name, className = "" }) => {
            const icons = {
                home: <g><path d="m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/><polyline points="9 22 9 12 15 12 15 22"/></g>,
                check: <polyline points="20 6 9 17 4 12"/>,
                chevronRight: <polyline points="9 18 15 12 9 6"/>,
                chevronLeft: <polyline points="15 18 9 12 15 6"/>,
                sparkles: <g><path d="m12 3 1.912 5.813a2 2 0 0 0 1.275 1.275L21 12l-5.813 1.912a2 2 0 0 0-1.275 1.275L12 21l-1.912-5.813a2 2 0 0 0-1.275-1.275L3 12l5.813-1.912a2 2 0 0 0 1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/></g>,
                user: <g><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></g>,
                mapPin: <g><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></g>,
                calendar: <g><rect x="3" y="4" width="18" height="18" rx="2" ry="2"/><line x1="16" y1="2" x2="16" y2="6"/><line x1="8" y1="2" x2="8" y2="6"/><line x1="3" y1="10" x2="21" y2="10"/></g>,
                refresh: <g><path d="M21 12a9 9 0 1 1-9-9c2.52 0 4.93 1 6.74 2.74L21 8"/><polyline points="21 3 21 8 16 8"/></g>,
                users: <g><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></g>,
                message: <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/>
            };
            return (
                <svg className={className} xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round">
                    {icons[name]}
                </svg>
            );
        };

        const STYLE_OPTIONS = [
            { id: 'nordic', title: '北歐', img: 'https://images.unsplash.com/photo-1598928506311-c55ded91a20c?auto=format&fit=crop&q=80&w=400' },
            { id: 'minimalist', title: '極簡', img: 'https://images.unsplash.com/photo-1513506003901-1e6a229e2d15?auto=format&fit=crop&q=80&w=400' },
            { id: 'wabisabi', title: '侘寂', img: 'https://images.unsplash.com/photo-1522771739844-6a9f6d5f14af?auto=format&fit=crop&q=80&w=400' },
            { id: 'industrial', title: '工業', img: 'https://images.unsplash.com/photo-1524758631624-e2822e304c36?auto=format&fit=crop&q=80&w=400' },
            { id: 'modern', title: '現代', img: 'https://images.unsplash.com/photo-1600210492486-724fe5c67fb0?auto=format&fit=crop&q=80&w=400' },
            { id: 'muji', title: '無印', img: 'https://images.unsplash.com/photo-1519710164239-da123dc03ef4?auto=format&fit=crop&q=80&w=400' }
        ];

        const LOCATIONS = ['台北市', '新北市', '桃園', '基隆', '其他'];
        const SPACE_USES = ['住家', '店面', '辦公空間'];
        const SERVICES = ['室內設計與裝潢', '預售屋客變'];
        const PURPOSES = ['長期自住', '短期自住', '出租', '賣房']; // 已將租屋改為出租
        const SOURCE_CHANNELS = ['Google', 'IG', 'Facebook', '官方網站', '設計家', '其他'];
        const MEMBER_SPECIAL_NEEDS = ['無', '有小朋友', '有長輩', '有寵物'];

        const INITIAL_STATE = {
            name: '', phone: '', lineId: '',
            location: '', otherLocation: '', address: '',
            houseAge: 0, spaceUse: '住家', service: '室內設計與裝潢',
            size: 25, budget: '100-200 萬',
            preferredStyles: [], otherStyle: '',
            familyCount: 2, familyFuture: '否', 
            hasSpecialMember: ['無'],
            purpose: '長期自住',
            sources: [], otherSource: '', 
            startDate: '', endDate: '', contactTime: '10:00 - 12:00',
            note: ''
        };

        function App() {
            const [step, setStep] = useState(0);
            const [isSubmitting, setIsSubmitting] = useState(false);
            const [isSuccess, setIsSuccess] = useState(false);
            const [formData, setFormData] = useState(INITIAL_STATE);

            // ⚠️ 請確保此 URL 與您的 Google Apps Script 部署 URL 一致
            const GOOGLE_SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzAbYpfxP805_XQWb7pLmDkXUiEHY5My03O87q76fTLs5Bukgqv8gzUpcU5SRhhv80/exec";

            const nextStep = () => setStep(s => s + 1);
            const prevStep = () => setStep(s => s - 1);
            const handleReset = () => { setFormData(INITIAL_STATE); setIsSuccess(false); setStep(0); };

            const canGoNext = useMemo(() => {
                if (step === 1) {
                    const phoneValid = formData.phone.length === 10 && /^\d+$/.test(formData.phone);
                    return formData.name && phoneValid;
                }
                if (step === 2) return formData.location && (formData.location !== '其他' || formData.otherLocation) && formData.address;
                if (step === 3) return formData.preferredStyles.length > 0;
                if (step === 5) return formData.hasSpecialMember.length > 0;
                if (step === 6) return formData.sources.length > 0;
                return true;
            }, [step, formData]);

            const toggleList = (field, value) => {
                setFormData(prev => ({
                    ...prev,
                    [field]: prev[field].includes(value) 
                        ? prev[field].filter(x => x !== value) 
                        : [...prev[field], value]
                }));
            };

            const toggleSpecialMember = (value) => {
                setFormData(prev => {
                    let newList;
                    if (value === '無') {
                        newList = ['無'];
                    } else {
                        newList = prev.hasSpecialMember.filter(x => x !== '無');
                        if (newList.includes(value)) {
                            newList = newList.filter(x => x !== value);
                        } else {
                            newList.push(value);
                        }
                        if (newList.length === 0) newList = ['無'];
                    }
                    return { ...prev, hasSpecialMember: newList };
                });
            };

            const handleSubmit = async () => {
                setIsSubmitting(true);
                const queryData = {
                    ...formData,
                    location: formData.location === '其他' ? `其他(${formData.otherLocation})` : formData.location,
                    preferredStyles: formData.preferredStyles.map(s => s === '其他' ? `其他(${formData.otherStyle})` : s).join(', '),
                    sources: formData.sources.map(s => s === '其他' ? `其他(${formData.otherSource})` : s).join(', '),
                    hasSpecialMember: formData.hasSpecialMember.join(', '),
                    timestamp: new Date().toLocaleString()
                };

                const queryParams = new URLSearchParams(queryData);
                try {
                    await fetch(`${GOOGLE_SCRIPT_URL}?${queryParams.toString()}`, { method: "POST", mode: "no-cors" });
                    setIsSuccess(true);
                } catch (e) {
                    alert("傳送失敗，請聯繫客服");
                } finally {
                    setIsSubmitting(false);
                }
            };

            const stepsCount = 7;

            return (
                <div className="min-h-screen flex items-center justify-center p-4 bg-slate-50">
                    {/* 進度條 */}
                    <div className="fixed top-0 left-0 w-full h-1.5 bg-slate-200 z-50">
                        <div className="h-full bg-amber-500 transition-all duration-700" style={{ width: `${(step / stepsCount) * 100}%` }}></div>
                    </div>

                    <div className="w-full max-w-[480px] bg-white rounded-[2.5rem] shadow-2xl shadow-slate-200 overflow-hidden flex flex-col min-h-[760px] relative border border-white">
                        <div className="flex-1 p-8 overflow-y-auto custom-scroll flex flex-col justify-center">
                            
                            {/* Step 0: 歡迎頁 */}
                            {step === 0 && (
                                <div className="text-center space-y-8 animate-in">
                                    <div className="w-24 h-24 bg-amber-50 rounded-full flex items-center justify-center mx-auto text-amber-600 shadow-inner">
                                        <Icon name="home" className="w-10 h-10"/>
                                    </div>
                                    <div className="space-y-3">
                                        <h1 className="text-3xl font-bold text-slate-800 tracking-tight">捷士設計 需求引導</h1>
                                        <p className="text-slate-500 text-base leading-relaxed">為了提供最精確的報價與規劃，<br/>請撥冗填寫以下資訊，讓我們更了解您的需求。</p>
                                    </div>
                                    <button onClick={nextStep} className="w-full py-5 bg-slate-900 text-white rounded-2xl font-bold flex items-center justify-center gap-3 hover:bg-slate-800 active:scale-[0.98] transition-all shadow-lg shadow-slate-200">
                                        開始填寫 <Icon name="chevronRight" className="w-5 h-5"/>
                                    </button>
                                </div>
                            )}

                            {/* Step 1: 基本資料 */}
                            {step === 1 && (
                                <div className="space-y-6 animate-in">
                                    <h2 className="text-2xl font-bold flex items-center gap-3 text-slate-800"><Icon name="user" className="text-amber-500"/> 聯絡資訊</h2>
                                    <div className="space-y-4">
                                        <div className="space-y-1.5">
                                            <label className="text-sm font-bold text-slate-600 ml-1">姓名 *</label>
                                            <input className="w-full p-4 rounded-2xl border-2 border-slate-100 bg-slate-50 outline-none focus:border-amber-400 focus:bg-white transition-all" placeholder="您的姓名" value={formData.name} onChange={e => setFormData({...formData, name: e.target.value})} />
                                        </div>
                                        <div className="space-y-1.5">
                                            <label className="text-sm font-bold text-slate-600 ml-1">聯絡電話 *</label>
                                            <input 
                                                className={`w-full p-4 rounded-2xl border-2 bg-slate-50 outline-none transition-all ${formData.phone && (formData.phone.length !== 10 || !/^\d+$/.test(formData.phone)) ? 'border-red-200 focus:border-red-400' : 'border-slate-100 focus:border-amber-400 focus:bg-white'}`} 
                                                placeholder="請輸入 10 位數字電話" 
                                                maxLength="10"
                                                value={formData.phone} 
                                                onChange={e => setFormData({...formData, phone: e.target.value.replace(/\D/g, '')})} 
                                            />
                                            {formData.phone && formData.phone.length !== 10 && <p className="text-xs text-red-500 font-medium ml-2">請輸入正確的手機號碼格式</p>}
                                        </div>
                                        <div className="space-y-1.5">
                                            <label className="text-sm font-bold text-slate-600 ml-1">Line ID (選填)</label>
                                            <input className="w-full p-4 rounded-2xl border-2 border-slate-100 bg-slate-50 outline-none focus:border-amber-400 focus:bg-white transition-all" placeholder="方便我們聯繫您" value={formData.lineId} onChange={e => setFormData({...formData, lineId: e.target.value})} />
                                        </div>
                                        <div className="space-y-2">
                                            <label className="text-sm font-bold text-slate-600 ml-1">方便聯絡時段</label>
                                            <div className="grid grid-cols-1 gap-2">
                                                {['10:00 - 12:00', '13:00 - 18:00', '18:00 - 21:00'].map(t => (
                                                    <button key={t} onClick={() => setFormData({...formData, contactTime: t})} className={`py-4 rounded-2xl border-2 text-sm font-bold transition-all ${formData.contactTime === t ? 'bg-amber-500 text-white border-amber-500 shadow-md shadow-amber-100' : 'bg-white text-slate-500 border-slate-100'}`}>{t}</button>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Step 2: 屋況地點 */}
                            {step === 2 && (
                                <div className="space-y-6 animate-in">
                                    <h2 className="text-2xl font-bold flex items-center gap-3 text-slate-800"><Icon name="mapPin" className="text-amber-500"/> 屋況與地點</h2>
                                    <div className="space-y-5">
                                        <div className="space-y-2">
                                            <label className="text-sm font-bold text-slate-600 ml-1">房屋地點 *</label>
                                            <div className="grid grid-cols-3 gap-2">
                                                {LOCATIONS.map(l => (
                                                    <button key={l} onClick={() => setFormData({...formData, location: l})} className={`py-3 rounded-2xl border-2 text-sm font-bold transition-all ${formData.location === l ? 'bg-amber-500 text-white border-amber-500 shadow-md' : 'bg-white text-slate-500 border-slate-100'}`}>{l}</button>
                                                ))}
                                            </div>
                                            {formData.location === '其他' && <input className="w-full p-4 rounded-2xl border-2 border-amber-200 bg-amber-50 text-sm animate-in outline-none" placeholder="請填寫具體地區" value={formData.otherLocation} onChange={e => setFormData({...formData, otherLocation: e.target.value})} />}
                                        </div>
                                        <div className="space-y-1.5">
                                            <label className="text-sm font-bold text-slate-600 ml-1">建案名稱或詳細地址 *</label>
                                            <input className="w-full p-4 rounded-2xl border-2 border-slate-100 bg-slate-50 outline-none focus:border-amber-400 focus:bg-white transition-all" placeholder="例如：捷士花園 12F" value={formData.address} onChange={e => setFormData({...formData, address: e.target.value})} />
                                        </div>
                                        
                                        <div className="grid grid-cols-2 gap-4">
                                            <div className="space-y-1.5">
                                                <label className="text-sm font-bold text-slate-600 ml-1">屋齡 (年)</label>
                                                <input type="number" min="0" className="w-full p-4 rounded-2xl border-2 border-slate-100 bg-slate-50 outline-none focus:border-amber-400" value={formData.houseAge} onChange={e => setFormData({...formData, houseAge: e.target.value})} />
                                            </div>
                                            <div className="space-y-1.5">
                                                <label className="text-sm font-bold text-slate-600 ml-1">空間用途</label>
                                                <select className="w-full p-4 rounded-2xl border-2 border-slate-100 bg-slate-50 outline-none font-bold text-slate-700" value={formData.spaceUse} onChange={e => setFormData({...formData, spaceUse: e.target.value})}>
                                                    {SPACE_USES.map(s => <option key={s} value={s}>{s}</option>)}
                                                </select>
                                            </div>
                                        </div>
                                        <div className="space-y-1.5">
                                            <label className="text-sm font-bold text-slate-600 ml-1">需要的服務</label>
                                            <select className="w-full p-4 rounded-2xl border-2 border-slate-100 bg-slate-50 outline-none font-bold text-slate-700" value={formData.service} onChange={e => setFormData({...formData, service: e.target.value})}>
                                                {SERVICES.map(s => <option key={s} value={s}>{s}</option>)}
                                            </select>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Step 3: 風格 */}
                            {step === 3 && (
                                <div className="space-y-6 animate-in">
                                    <h2 className="text-2xl font-bold flex items-center gap-3 text-slate-800"><Icon name="sparkles" className="text-amber-500"/> 風格選擇</h2>
                                    <div className="space-y-4">
                                        <label className="text-sm font-bold text-slate-600 ml-1">預計風格 (可複選) *</label>
                                        <div className="grid grid-cols-2 gap-4">
                                            {STYLE_OPTIONS.map(s => (
                                                <div 
                                                    key={s.id} 
                                                    onClick={() => toggleList('preferredStyles', s.title)} 
                                                    className={`cursor-pointer rounded-[2rem] border-2 p-2 text-center transition-all ${formData.preferredStyles.includes(s.title) ? 'border-amber-500 bg-amber-50 shadow-lg shadow-amber-100' : 'border-slate-50 hover:border-slate-200 bg-slate-50'}`}
                                                >
                                                    <img src={s.img} className="w-full h-24 object-cover rounded-[1.5rem] mb-3" />
                                                    <span className={`text-sm font-bold ${formData.preferredStyles.includes(s.title) ? 'text-amber-700' : 'text-slate-600'}`}>{s.title}</span>
                                                </div>
                                            ))}
                                            <div 
                                                onClick={() => toggleList('preferredStyles', '其他')} 
                                                className={`flex items-center justify-center border-2 rounded-[2rem] text-sm font-bold h-[154px] cursor-pointer transition-all ${formData.preferredStyles.includes('其他') ? 'border-amber-500 bg-amber-50 text-amber-700' : 'border-slate-50 bg-slate-50 hover:border-slate-200 text-slate-400'}`}
                                            >
                                                其他
                                            </div>
                                        </div>
                                        {formData.preferredStyles.includes('其他') && (
                                            <input 
                                                className="w-full p-4 rounded-2xl border-2 border-amber-200 bg-amber-50 text-sm animate-in outline-none" 
                                                placeholder="請描述您喜好的風格特色..." 
                                                value={formData.otherStyle} 
                                                onChange={e => setFormData({...formData, otherStyle: e.target.value})} 
                                            />
                                        )}
                                    </div>
                                </div>
                            )}

                            {/* Step 4: 坪數預算 */}
                            {step === 4 && (
                                <div className="space-y-8 animate-in">
                                    <h2 className="text-2xl font-bold flex items-center gap-3 text-slate-800"><Icon name="sparkles" className="text-amber-500"/> 坪數與預算</h2>
                                    <div className="space-y-8">
                                        <div className="bg-slate-50 p-8 rounded-[2.5rem] space-y-6 border border-white">
                                            <div className="flex justify-between items-end">
                                                <span className="text-base font-bold text-slate-500">室內坪數 *</span>
                                                <span className="text-4xl font-black text-amber-600 tracking-tight">{formData.size} <span className="text-lg font-normal">坪</span></span>
                                            </div>
                                            <input type="range" min="5" max="150" className="w-full accent-amber-500 h-2.5 bg-slate-200 rounded-lg appearance-none cursor-pointer" value={formData.size} onChange={e => setFormData({...formData, size: e.target.value})} />
                                            <div className="flex justify-between text-xs font-bold text-slate-400 px-1">
                                                <span>5坪</span><span>50坪</span><span>100坪</span><span>150坪</span>
                                            </div>
                                        </div>
                                        <div className="space-y-3">
                                            <label className="text-sm font-bold text-slate-600 ml-1">裝潢預算區間</label>
                                            <div className="grid grid-cols-1 gap-2.5">
                                                {['100 萬以下', '100-200 萬', '200-500 萬', '500 萬以上'].map(b => (
                                                    <button 
                                                        key={b} 
                                                        onClick={() => setFormData({...formData, budget: b})} 
                                                        className={`py-5 rounded-2xl border-2 text-base font-bold transition-all ${formData.budget === b ? 'bg-slate-800 text-white border-slate-800 shadow-xl' : 'bg-white text-slate-500 border-slate-100 hover:border-slate-300'}`}
                                                    >
                                                        {b}
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Step 5: 成員與目的 */}
                            {step === 5 && (
                                <div className="space-y-6 animate-in">
                                    <h2 className="text-2xl font-bold flex items-center gap-3 text-slate-800"><Icon name="users" className="text-amber-500"/> 成員與目的</h2>
                                    <div className="space-y-5">
                                        <div className="grid grid-cols-2 gap-4">
                                            <div className="space-y-1.5">
                                                <label className="text-sm font-bold text-slate-600 ml-1">居住人數</label>
                                                <input type="number" min="1" className="w-full p-4 rounded-2xl border-2 border-slate-100 bg-slate-50 outline-none focus:border-amber-400" value={formData.familyCount} onChange={e => setFormData({...formData, familyCount: e.target.value})} />
                                            </div>
                                            <div className="space-y-1.5">
                                                <label className="text-sm font-bold text-slate-600 ml-1">預留變動空間</label>
                                                <div className="flex border-2 border-slate-100 rounded-2xl overflow-hidden h-[60px] bg-slate-50 p-1">
                                                    {['是', '否'].map(opt => (
                                                        <button key={opt} onClick={() => setFormData({...formData, familyFuture: opt})} className={`flex-1 text-sm font-bold rounded-xl transition-all ${formData.familyFuture === opt ? 'bg-white text-slate-800 shadow-sm' : 'text-slate-400 hover:text-slate-600'}`}>{opt}</button>
                                                    ))}
                                                </div>
                                            </div>
                                        </div>
                                        <div className="space-y-2">
                                            <label className="text-sm font-bold text-slate-600 ml-1">成員需求 (可複選) *</label>
                                            <div className="grid grid-cols-2 gap-2.5">
                                                {MEMBER_SPECIAL_NEEDS.map(opt => (
                                                    <button 
                                                        key={opt} 
                                                        onClick={() => toggleSpecialMember(opt)} 
                                                        className={`py-4 rounded-2xl border-2 text-sm font-bold transition-all ${formData.hasSpecialMember.includes(opt) ? 'bg-amber-500 text-white border-amber-500 shadow-md shadow-amber-100' : 'bg-white text-slate-400 border-slate-100 hover:bg-slate-50'}`}
                                                    >
                                                        {opt}
                                                    </button>
                                                ))}
                                            </div>
                                        </div>
                                        <div className="space-y-2">
                                            <label className="text-sm font-bold text-slate-600 ml-1">裝潢目的</label>
                                            <div className="grid grid-cols-2 gap-2.5">
                                                {PURPOSES.map(p => (
                                                    <button key={p} onClick={() => setFormData({...formData, purpose: p})} className={`py-4 rounded-2xl border-2 text-sm font-bold transition-all ${formData.purpose === p ? 'border-slate-800 bg-slate-800 text-white shadow-xl' : 'border-slate-100 text-slate-400 hover:border-slate-300'}`}>{p}</button>
                                                ))}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Step 6: 得知管道與其他 */}
                            {step === 6 && (
                                <div className="space-y-6 animate-in">
                                    <h2 className="text-2xl font-bold flex items-center gap-3 text-slate-800"><Icon name="calendar" className="text-amber-500"/> 最後一步</h2>
                                    <div className="space-y-5">
                                        <div className="grid grid-cols-2 gap-4">
                                            <div className="space-y-1.5">
                                                <label className="text-sm font-bold text-slate-600 ml-1">期待開工</label>
                                                <input type="date" className="w-full p-4 rounded-2xl border-2 border-slate-100 bg-slate-50 text-sm outline-none focus:border-amber-400" value={formData.startDate} onChange={e => setFormData({...formData, startDate: e.target.value})} />
                                            </div>
                                            <div className="space-y-1.5">
                                                <label className="text-sm font-bold text-slate-600 ml-1">期待完工</label>
                                                <input type="date" className="w-full p-4 rounded-2xl border-2 border-slate-100 bg-slate-50 text-sm outline-none focus:border-amber-400" value={formData.endDate} onChange={e => setFormData({...formData, endDate: e.target.value})} />
                                            </div>
                                        </div>
                                        <div className="space-y-2">
                                            <label className="text-sm font-bold text-slate-600 ml-1">得知管道 (可複選) *</label>
                                            <div className="grid grid-cols-3 gap-2">
                                                {SOURCE_CHANNELS.map(s => (
                                                    <div 
                                                        key={s} 
                                                        onClick={() => toggleList('sources', s)} 
                                                        className={`p-3 rounded-xl border-2 text-[11px] font-bold cursor-pointer text-center transition-all ${formData.sources.includes(s) ? 'border-amber-500 bg-amber-50 text-amber-700 shadow-sm' : 'border-slate-100 text-slate-400 bg-slate-50 hover:border-slate-300'}`}
                                                    >
                                                        {s}
                                                    </div>
                                                ))}
                                            </div>
                                            {formData.sources.includes('其他') && <input className="w-full p-4 rounded-2xl border-2 border-amber-200 bg-amber-50 text-sm mt-2 animate-in outline-none" placeholder="請填寫來源管道" value={formData.otherSource} onChange={e => setFormData({...formData, otherSource: e.target.value})} />}
                                        </div>
                                        <div className="space-y-1.5">
                                            <label className="text-sm font-bold text-slate-600 ml-1 flex items-center gap-2"><Icon name="message" className="w-4 h-4"/> 備註或其他需求</label>
                                            <textarea className="w-full p-5 rounded-2xl border-2 border-slate-100 bg-slate-50 text-sm h-32 outline-none focus:border-amber-400 focus:bg-white custom-scroll resize-none" placeholder="您可以補充任何特別的想法或是您最在意的空間需求..." value={formData.note} onChange={e => setFormData({...formData, note: e.target.value})}></textarea>
                                        </div>
                                    </div>
                                </div>
                            )}

                            {/* Step 7: 送出頁 */}
                            {step === 7 && (
                                <div className="text-center space-y-8 animate-in">
                                    <div className={`w-24 h-24 rounded-full flex items-center justify-center mx-auto shadow-inner ${isSuccess ? 'bg-green-50 text-green-600' : 'bg-amber-50 text-amber-600'}`}>
                                        <Icon name={isSuccess ? "check" : "sparkles"} className="w-10 h-10"/>
                                    </div>
                                    <div className="space-y-3">
                                        <h2 className="text-3xl font-bold text-slate-800">{isSuccess ? '送出成功！' : '資料確認'}</h2>
                                        <p className="text-slate-500 text-base leading-relaxed">{isSuccess ? '感謝您的填寫！我們將儘快在您方便的時段致電洽詢，為您開啟美好的裝修規劃。' : '請確認資訊填寫正確，點擊下方按鈕正式送出需求單。'}</p>
                                    </div>
                                    {isSuccess ? (
                                        <button onClick={handleReset} className="w-full py-5 bg-slate-900 text-white rounded-2xl font-bold flex items-center justify-center gap-3 hover:bg-slate-800 shadow-xl active:scale-[0.98] transition-all">
                                            <Icon name="refresh" className="w-5 h-5"/> 再次填寫案件
                                        </button>
                                    ) : (
                                        <button onClick={handleSubmit} disabled={isSubmitting} className="w-full py-5 bg-amber-500 text-white rounded-2xl font-bold shadow-xl shadow-amber-100 hover:bg-amber-600 active:scale-[0.98] transition-all disabled:bg-amber-300 disabled:cursor-not-allowed">
                                            {isSubmitting ? '正在為您傳送需求...' : '確認並送出'}
                                        </button>
                                    )}
                                </div>
                            )}
                        </div>

                        {/* 下方控制按鈕 */}
                        {step > 0 && (
                            <div className="px-8 pb-8 bg-white border-t border-slate-50 pt-6 flex gap-3">
                                {(!isSuccess || step === 7) && (
                                    <button onClick={prevStep} className="p-5 rounded-2xl border-2 border-slate-100 text-slate-400 hover:bg-slate-50 active:scale-[0.95] transition-all">
                                        <Icon name="chevronLeft" className="w-6 h-6"/>
                                    </button>
                                )}
                                {step < 7 && (
                                    <button 
                                        onClick={nextStep} 
                                        disabled={!canGoNext}
                                        className={`flex-1 py-5 rounded-2xl font-bold text-base transition-all active:scale-[0.98] ${canGoNext ? 'bg-slate-900 text-white hover:bg-slate-800 shadow-xl shadow-slate-200' : 'bg-slate-100 text-slate-300 cursor-not-allowed'}`}
                                    >
                                        下一頁
                                    </button>
                                )}
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
